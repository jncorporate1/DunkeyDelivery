@model DunkeyDelivery.Areas.User.Models.PharmacyViewModel
@{
    ViewBag.Title = "Store Details";
    Layout = "~/Areas/User/Views/Shared/_Layout.cshtml";
}
<style>
    .medication_dropdown
    {
    position: absolute;
    background-color: lightgrey;
    width: 90%;
    height:auto;
    overflow-y: auto;

    display:none;
     }
    .medication_dropdown a{
      width:100%;
      border-bottom: 1px solid #6ebe44;
      padding-left: 16px;
      text-decoration: none;
    }
    .medication_dropdown a:hover{
        background-color:#6ebe44;
        color:white;
    }
    #ui-datepicker-div > .medication_dropdown a p:hover{
      
        color:white;
    }
    .ui-widget-header{
       background-color:#6ebe44;
    }
    .medicine_name{
            padding-bottom: 7px !important;
    margin-bottom: 7px !important;
    width: 100%;
    height: 100%;
    padding: 0px 0px 0px 0px !important;
    margin: 0px 0px 0px 0px !important;
    }
</style>
<script>
    var fields=0;
    var Field_id;


</script>

<link href="https://code.jquery.com/ui/1.10.4/themes/ui-lightness/jquery-ui.css"
      rel="stylesheet">
<script src="https://code.jquery.com/jquery-1.10.2.js"></script>
<script src="https://code.jquery.com/ui/1.10.4/jquery-ui.js"></script>

<div class="top-banner product-detail-banner">
    <img src="~/Content/assets/images/pharmacy-banner.png" class="img img-responsive" />
    <div class="banner-inner-text" />
    <img src="@Model.storeViewModel.ImageUrl" class="logo-img common-logo-height" />
    <div class="row">
        @for (var i = 1; i <= 5; i++)
        {
            if (Model.storeViewModel.AverageRating == 0)
            {
                <span><i class="icon fa fa fa-star-o"></i></span>}
            else if (i - Model.storeViewModel.AverageRating <= 0)
            {
                <span><i class="icon fa fa-star"></i></span>    // rating
            }
            else if (i - Model.storeViewModel.AverageRating < 1)
            {
                <span><i class="icon fa fa-star-half-full"></i></span>    // half rating
            }
            else
            {
                <span><i class="icon fa fa-star-o"></i></span>    // no rating
            }
        }
    </div>
    <h1 class="product-heading-banner">@Model.storeViewModel.BusinessName</h1>

    <p class="banner-inner-data">@Model.storeViewModel.Address</p>
    <p class="banner-inner-data">Min $ @Model.storeViewModel.MinOrderPrice  |  Estimated time @Model.storeViewModel.MinDeliveryTime min</p>
</div>
</div>
<div class="current-menu-paths">
    <div class="container">
        <p> Home > Restaurants   >  @Model.storeViewModel.BusinessName </p>
    </div>
</div>

<div class="main-section product-detail-main pharmacy-details-main">

    <div class="container">
        <div class="row">
            <div class="col-md-9">
                <ul class="tabs-list clearfix">
                    <li>
                        <button class="tab-btn tablinks" onclick="openCity(event, 'London')" id="defaultOpen">Menu</button>
                    </li>
                    <li>
                        <button class="tab-btn tablinks" onclick="openCity(event, 'paris')">Reviews</button>
                    </li>
                    <li>
                        <button class="tab-btn tablinks" id="info-tab" onclick="openCity(event, 'newyork')">Info</button>
                    </li>
                </ul>

                <!-- TAB CONTENT -->
                @using (Ajax.BeginForm("SubmitPharmacyForm", "Pharmacy",FormMethod.Post, new AjaxOptions { OnSuccess = "test", OnFailure = "failtest" }))
                {
                   @Html.AntiForgeryToken()
                    <div class="tab1 tabcontent" id="London">
                        <div class="row">
                            <div class="col-md-12">

                                <div class="tab">
                                    <div class="pharmacy-details clearfix">
                                        <h4>DRUGS DetailS</h4>
                                        <div class="pharmacy-details-cont">
                                            <p>You may add multiple medications below</p>
                                            <div id="more_fields" >
                                                <input type="text" id="field_0" onkeyup="medications(this.id,this.value)" name="medication" placeholder="Enter Medication" autocomplete="off"/>
                                                @Html.ValidationMessageFor(m => m.medication, "", new { @class = "text-danger error" })

                                            </div>
                                            <div class="medication_dropdown">
                                                <p class="medicine_name" >Medicine Name</p>
                                           
                                            </div>  
                                            @*@Html.TextBoxFor(x => x.medication, new { name = "medication", @placeholder = "Xanax", @autocomplete = "off" })
                                            @Html.ValidationMessageFor(m => m.medication, "", new { @class = "text-danger error" })*@
                                            <a onclick="add_fields()" style="cursor:pointer">Add more Medication</a>


                                        </div>
                                       
                                    </div>

                                    <div class="pharmacy-details clearfix">
                                        <h4>Who Worte your prescription</h4>
                                        <div class="pharmacy-details-cont">
                                            <p>The pharmacy will confirm your Rx with this doctor</p>
                                            <div class="bottom-margin">
                                                @Html.TextBoxFor(x => x.DoctorFirstName, new { name = "DoctorFirstName", @placeholder = "Doctor First Name" })
                                                @Html.ValidationMessageFor(m => m.DoctorFirstName, "", new { @class = "text-danger error" })
                                            </div>
                                            <div class="bottom-margin">
                                                @Html.TextBoxFor(x => x.DoctorLastName, new { name = "DoctorLastName", @placeholder = "Doctor Last Name" })
                                                @Html.ValidationMessageFor(m => m.DoctorLastName, "", new { @class = "text-danger error" })
                                            </div>
                                            <div class="bottom-margin">
                                                @Html.TextBoxFor(x => x.DoctorPhone, new { name = "DoctorPhone", @placeholder = "Doctor Phone" })
                                                @Html.ValidationMessageFor(m => m.DoctorPhone, "", new { @class = "text-danger error" })
                                            </div>

                                        </div>

                                    </div>

                                    <div class="pharmacy-details clearfix">
                                        <h4>PATIENT DETAILS</h4>
                                        <div class="pharmacy-details-cont">
                                            <p> We use encryption to keep your information safe.</p>
                                            <div class="bottom-margin">
                                                @Html.TextBoxFor(x => x.PatientFirstName, new { name = "PatientFirstName", @placeholder = "Enter First Name" })
                                                @Html.ValidationMessageFor(m => m.PatientFirstName, "", new { @class = "text-danger error" })
                                            </div>
                                            <div class="bottom-margin">
                                                @Html.TextBoxFor(x => x.DoctorLastName, new { name = "DoctorLastName", @placeholder = "Enter Last Name" })
                                                @Html.ValidationMessageFor(m => m.DoctorLastName, "", new { @class = "text-danger error" })
                                            </div>

                                            <div class="row">
                                                <div class="col-md-6" style="padding-left:0px;">
                                                   <input type="text" name="DateOfBirth" placeholder="Birth Date" id="datepicker-13">

                                                    @*@Html.TextBoxFor(x => x.DateOfBirth, new { name = "DateOfBirth", @placeholder = "Birth Date" })*@
                                                    @Html.ValidationMessageFor(m => m.DateOfBirth, "", new { @class = "text-danger error" })
                                                </div>
                                                <div class="col-md-6" style="padding-right:0px;">
                                                    <select style="height: 56px;padding-bottom: 0px;padding-top: 0px;" required>
                                                        <option>Gender</option>
                                                        <option>Male</option>
                                                        <option>Female</option>
                                                    </select>
                                                </div>
                                            </div>
                                        </div>

                                    </div>

                                    <div class="pharmacy-details clearfix">
                                        <h4>DeLivery Details</h4>
                                        <div class="pharmacy-details-cont">
                                            <p> Your address will be sent securely to the pharmacy</p>
                                                <div class="row" style="margin-bottom:15px;">
                                                    @Html.TextBoxFor(x => x.Address, new { name = "Address", @placeholder = "Address" })
                                                    @Html.ValidationMessageFor(m => m.Address, "", new { @class = "text-danger error" })
                                                </div>
                                                <div class="row" style="margin-bottom:15px;">
                                                    <div class="col-md-6" style="padding-left:0px;">
                                                        @Html.TextBoxFor(x => x.City, new { name = "City", @placeholder = "City" })
                                                        @Html.ValidationMessageFor(m => m.City, "", new { @class = "text-danger error" })
                                                    </div>

                                                    <div class="col-md-3">
                                                        @Html.TextBoxFor(x => x.State, new { name = "State", @placeholder = "State" })
                                                        @Html.ValidationMessageFor(m => m.State, "", new { @class = "text-danger error" })
                                                    </div>
                                                    <div class="col-md-3" style="padding-right:0px;">
                                                        @Html.TextBoxFor(x => x.ZipCode, new { name = "ZipCode", @placeholder = "Zip Code" })
                                                        @Html.ValidationMessageFor(m => m.ZipCode, "", new { @class = "text-danger error" })
                                                    </div>


                                                </div>


                                            <div class="row" style="margin-bottom:15px;">
                                                @Html.TextBoxFor(x => x.DeliveryPhone, new { name = "DeliveryPhone", @placeholder = "Phone Number" })
                                                @Html.ValidationMessageFor(m => m.DeliveryPhone, "", new { @class = "text-danger error" })

                                            </div>
                                                <p id="test" style="color:green;display:none;">Your request is submitted. We will contact you shortly.</p>

                                                <input type="submit" value="SUBMIT" />

                                            </div>

                                        </div>


                                    </div>
                                </div>





                            </div>
                        </div>
                        }
                        <div class="tab1 tabcontent" id="paris">
                            <h1>No content</h1>
                        </div>
                        <div class="tab1 tabcontent" id="newyork">

                            <div class="location-info clearfix">
                                <h3>
                                    @Model.storeViewModel.Address
                                </h3>
                                <div id="map"></div>


                            </div>

                            <div class="time-info clearfix" style="background-color:#FFF;">
                                <div class="col-md-12 nopadleft">
                                    <h3>Delivery hours</h3>
                                    <ul>
                                        @if (Model.storeViewModel.StoreDeliveryHours!= null)
                                        {

                                            //foreach (var item in Model.storeViewModel.StoreDeliveryHours)
                                            //{

                                                <li> <div class="left">Mon @DateTime.Now.ToString("dd/MM") </div>      <div class="right">@Model.storeViewModel.StoreDeliveryHours.Monday_From.ToString(@"hh\:mm")  - @Model.storeViewModel.StoreDeliveryHours.Monday_To.ToString(@"hh\:mm")</div></li>
                                                <li> <div class="left">Tue @DateTime.Now.ToString("dd/MM") </div>      <div class="right">@Model.storeViewModel.StoreDeliveryHours.Tuesday_From.ToString(@"hh\:mm")  - @Model.storeViewModel.StoreDeliveryHours.Tuesday_To.ToString(@"hh\:mm")</div></li>
                                                <li> <div class="left">Wed @DateTime.Now.ToString("dd/MM") </div>      <div class="right">@Model.storeViewModel.StoreDeliveryHours.Wednesday_From.ToString(@"hh\:mm")  - @Model.storeViewModel.StoreDeliveryHours.Wednesday_To.ToString(@"hh\:mm")</div></li>
                                                <li> <div class="left">Thu @DateTime.Now.ToString("dd/MM") </div>      <div class="right">@Model.storeViewModel.StoreDeliveryHours.Thursday_From.ToString(@"hh\:mm")  - @Model.storeViewModel.StoreDeliveryHours.Thursday_To.ToString(@"hh\:mm")</div></li>
                                                <li> <div class="left">Fri @DateTime.Now.ToString("dd/MM") </div>      <div class="right">@Model.storeViewModel.StoreDeliveryHours.Friday_From.ToString(@"hh\:mm")  - @Model.storeViewModel.StoreDeliveryHours.Friday_To.ToString(@"hh\:mm")</div></li>
                                                <li> <div class="left">Sat @DateTime.Now.ToString("dd/MM") </div>      <div class="right">@Model.storeViewModel.StoreDeliveryHours.Saturday_From.ToString(@"hh\:mm")  - @Model.storeViewModel.StoreDeliveryHours.Saturday_To.ToString(@"hh\:mm")</div></li>
                                                <li> <div class="left">Sun @DateTime.Now.ToString("dd/MM") </div>      <div class="right">@Model.storeViewModel.StoreDeliveryHours.Sunday_From.ToString(@"hh\:mm")  - @Model.storeViewModel.StoreDeliveryHours.Sunday_To.ToString(@"hh\:mm")</div></li>

                                            //}
                                        }
                                        else
                                        {

                                            <li> Delivery Time Not Available</li>
                                        }


                                    </ul>

                                </div>
                            </div>
                        </div>

                        <script>
                            function test() {

                                $("#test").show();
                            }
                            function failtest() {

                                $("#failtest").show();
                            }

                        </script>

                    </div>

                </div>


            </div>

        </div>
<script>

        var BusinessName="@Model.storeViewModel.BusinessName";
        var BusinessImage="@Model.storeViewModel.ImageUrl";
        var PointerLoc= {lat: @Model.storeViewModel.Latitude, lng:@Model.storeViewModel.Latitude};
        BusinessImage=encodeURI(BusinessImage);
        $('#info-tab').on('click',function(){
            initMap();
            $("#map").click();
        });

        function initMap() {
            var myLatLng = PointerLoc;

            var map = new google.maps.Map(document.getElementById('map'), {
                zoom: 10,
                center: myLatLng
            });

            var marker = new google.maps.Marker({
                position: myLatLng,
                map: map

            });
        }

    

</script>
<script async defer
        src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBsTtPvdkmkD6v7vu9QRzrTEPXwdsLDu3Y&libraries=places&callback">
</script>
<script>
    function add_fields(){
        $("#more_fields").append('<input type="text" onkeyup="medications(this.id,this.value)" id="field_'+fields+'" name="medication" placeholder="Enter Medication" autocomplete="off"/>');
        fields++;
        
    }
    function medications(field_id,name){
        Field_id=field_id;
        if(name.length>3){

        
            $.ajax({
        
                url: '@Url.Action("MedicationNames", "Pharmacy", new { Area = "User" })',
                type: "GET",
                data: { Store_Id: @Model.storeViewModel.Id,Name:name },
                success: function (data) {
                    $(".medication_dropdown").html("");
                    if(data.medications.length>0){
        
                        for(var i=0;i<data.medications.length;i++){
                            $(".medication_dropdown").append('<a onclick="medicine_tofield(this.id)" id="'+data.medications[i].Id+'" ><p class="medicine_name" >'+data.medications[i].Name+'</p></a>');
                            $(".medication_dropdown").show();
                            $(".medication_dropdown").css("display","block");
                           
                        }
                      
                   
                    }
                    
                }, error: function (xhr, status, error) {

                }
            });
        }else{
            $(".medication_dropdown").css("display","none");
            $(".medication_dropdown").hide();
        }
    }
    function medicine_tofield(medicine_id){
        var med_name=$("#"+medicine_id+" p").text();
        $("#"+Field_id).val(med_name);
        $(".medication_dropdown").css("display","none");
        $(".medication_dropdown").hide();
        

        
    }

</script>
        <script>

            function openCity(evt, cityName) {
                // Declare all variables
                var i, tabcontent, tablinks;

                // Get all elements with class="tabcontent" and hide them
                tabcontent = document.getElementsByClassName("tabcontent");
                for (i = 0; i < tabcontent.length; i++) {
                    tabcontent[i].style.display = "none";
                }

                // Get all elements with class="tablinks" and remove the class "active"
                tablinks = document.getElementsByClassName("tablinks");
                for (i = 0; i < tablinks.length; i++) {
                    tablinks[i].className = tablinks[i].className.replace(" active", "");
                }

                // Show the current tab, and add an "active" class to the button that opened the tab
                document.getElementById(cityName).style.display = "block";
                evt.currentTarget.className += " active";


            }
            // Get the element with id="defaultOpen" and click on it
            document.getElementById("defaultOpen").click();

        </script>
<script type="text/javascript">
    $( "#datepicker-13" ).datepicker();
</script>   